excel报表导出，除了sql本身优化，以下几点可以关注下：

1.查询时间跨度太大可能不会走索引（虽然时间字段建了索引），采取分割查询日期，如查询日期2018-06-06至2018-06-26 ， 后台将日期区间分成【2018-06-06、2018-06-07、2018-06-08。。。。】分别查询，
这样也可以减少每次sql查询结果的总量，limit查询会随起始值增大而效率会降低。比如量大的情况下,同一查询语句， 加上分页limit 1000,100 比 limit 10000,100会快很多。

2.分页查询适当加大每页查询的数量（pageSize），500或1000，减少查询次数，这个需要根据实际情况调节，pageSize设置过大也会影响效率。
例如有3000条数据，pageSize设为10，则需要分页查询100次，每次耗时0.1秒，总时间需要10秒，如果pageSize设置为200，则只需要查询15次，每次耗时0.3秒，总时间4.5秒。

3.分页查询可以不用每次都查询总量，如果是PageHelper分页,默认情况每次都会先查询totalCount，select count(1) from (your sql) ,然后再查询数据，这个totalCount消耗时间，对我们导报表却没任何用处。
可以设置PageHelper.startPage(pageNo,pageSize,false)第三个参数设置为false，这样就不会去查询totalCount了，可以根据查询结果list为空来判断已到最后一页。

4.导出数据量大时，应避免使用jxls的模板导出，这个不支持分页导出，应使用poi动态分页生成excel，各系统都有例子